<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>3. Rust - DOC.TON.DEV</title>
        <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../../..">DOC.TON.DEV</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">1. Compilers <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../1. Compilers/ABI Specification/">ABI Specification</a>
</li>
                                    
<li >
    <a href="../../../../1. Compilers/Intro/">Intro</a>
</li>
                                    
<li >
    <a href="../../../../1. Compilers/Linker CLI/">Linker CLI</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">LLVM</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../1. Compilers/LLVM/1. Compiler Highlights/">1. Compiler Highlights</a>
</li>
            
<li >
    <a href="../../../../1. Compilers/LLVM/2. C Support Status/">Language Features</a>
</li>
            
<li >
    <a href="../../../../1. Compilers/LLVM/3. C to TVM Library/">3. C to TVM Library</a>
</li>
            
<li >
    <a href="../../../../1. Compilers/LLVM/4. Debugging Options/">4. Debugging Options</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Solidity</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../1. Compilers/Solidity/1. Support status/">1. Support status</a>
</li>
            
<li >
    <a href="../../../../1. Compilers/Solidity/2. Reference Guide/">2. Reference Guide</a>
</li>
            
<li >
    <a href="../../../../1. Compilers/Solidity/3. Usage/">3. Usage</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">2. SDK <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../1. Installation/">1. Installation</a>
</li>
                                    
<li >
    <a href="../../../2. Overview/">2. Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Auxiliaries</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Auxiliaries/Getting Logs/">Getting Logs</a>
</li>
            
<li >
    <a href="../../../Auxiliaries/Installing Ubuntu VM/">Installing Ubuntu VM</a>
</li>
            
<li >
    <a href="../../../Auxiliaries/TON SDK CLI/">TON SDK CLI</a>
</li>
            
<li >
    <a href="../../../Auxiliaries/Troubleshooting/">Troubleshooting</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Client Libraries</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">Library Modules</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../Library Modules/1. Contracts/">1. Contracts</a>
</li>
            
<li >
    <a href="../../Library Modules/2. Queries/">2. Queries</a>
</li>
            
<li >
    <a href="../../Library Modules/3. Crypto/">3. Crypto</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Using Libraries</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../2. Node.js/">2. Node.js</a>
</li>
            
<li class="active">
    <a href="./">3. Rust</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Local node</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../Local node/Local Node/">Local Node</a>
</li>
            
<li >
    <a href="../../../Local node/Node SE Giver/">Node SE Giver</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TON Labs Testnet</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../TON Labs Testnet/Testnet Giver/">Testnet Giver</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">3. TON Blockchain <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../3. TON Blockchain/Gal Calculation Basics/">Gas Calculation Basics</a>
</li>
                                    
<li >
    <a href="../../../../3. TON Blockchain/Replay Attack Protection/">Replay Attack Protection</a>
</li>
                                    
<li >
    <a href="../../../../3. TON Blockchain/Storage Fee Calculation/">Welcome to MkDocs</a>
</li>
                                    
<li >
    <a href="../../../../3. TON Blockchain/TVM Error Codes/">TVM Error Codes</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">4. FAQ <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../4. FAQ/">TON Dev Documentation</a>
</li>
                                    
<li >
    <a href="../../../../4. FAQ/SDK and Integration/">SDK and Integration</a>
</li>
                                    
<li >
    <a href="../../../../4. FAQ/Smart Contracts/">Smart Contracts</a>
</li>
                                    
<li >
    <a href="../../../../4. FAQ/Solidity Compiler/">Solidity Compiler</a>
</li>
                                    
<li >
    <a href="../../../../4. FAQ/TON and TVM/">TON and TVM</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">5. Misc <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../5. Misc/Glossary/">The Moonspeak</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../2. Node.js/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../../../Local node/Local Node/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#creating-a-contract">Creating a contract</a></li>
        <li class="main "><a href="#creating-an-app">Creating an app</a></li>
        <li class="main "><a href="#deployment">Deployment</a></li>
        <li class="main "><a href="#running-a-contract">Running a contract</a></li>
        <li class="main "><a href="#querying-blockchain">Querying blockchain</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>Make sure to create a local folder for all your test projects.</p>
<h2 id="creating-a-contract">Creating a contract</h2>
<ol>
<li>Create the "hello" folder and place the "hello.sol" contract source code into it:</li>
</ol>
<pre><code class="javascript">pragma solidity &gt;=0.5.0 &lt;0.6.0;
contract HelloTON {
    uint32 deployTime;
  constructor() public {
        deployTime = uint32(now);
    }
    function sayHello() public view returns (uint32) {
        return deployTime;
    }
}   
</code></pre>

<ol>
<li>
<p>Call <code>cd hello</code> to navigate to the new folder.</p>
</li>
<li>
<p>Run the TON Labs Solidity compiler:</p>
</li>
</ol>
<pre><code class="shell">tondev sol hello
</code></pre>

<h2 id="creating-an-app">Creating an app</h2>
<p>To get a functional playground, we need blockchain infrastructure for contract testing and debugging. We suggest using our Node SE. </p>
<p>Make sure that you ran a Node SE instant according to the guidelines provided in the <a href="https://docs.ton.dev/86757ecb2/p/28b6ba"><strong>Installation</strong></a> section.</p>
<pre><code class="shell">tondev start            
</code></pre>

<blockquote>
<p><strong>Note:</strong> To create an application according to this procedure, you have to install the newest Rust compiler.</p>
</blockquote>
<ol>
<li>Initialize a Rust application in the hello directory:</li>
</ol>
<pre><code class="shell">~/ton-dev/hello$ cargo init
Created binary (application) package  
</code></pre>

<ol>
<li>Open the newly created <code>Cargo.toml</code> file in your preferred editor and add following line to the <code>[dependencies]</code> section:</li>
</ol>
<pre><code class="shell"> ton-client-rs = &quot;0.11.1&quot;            
</code></pre>

<p>It enables using TON SDK Client package in your <code>hello</code> project.</p>
<ol>
<li>Connect to the local node (Node SE) or to TON Labs testnet. In Rust Client Libraries the <code>TONClient</code> class is used to connect to TON Blockchain nodes that can work with SDK. </li>
</ol>
<p>If you use Node SE, specify <code>new_with_base_url("&lt;http://0.0.0.0&gt;")</code> (local URL).</p>
<blockquote>
<p><strong>Important</strong>: for Windows use <a href="http://127.0.0.1/">http://127.0.0.1/</a> or <a href="http://localhost/">http://localhost</a>.</p>
</blockquote>
<p>If you use the testnet, specify its URL. For test purposes, use Ton Labs test net URL <code>new_with_base_url('&lt;https://testnet.ton.dev&gt;')</code></p>
<p>Go to the <a href="http://main.rs/">main.rs</a> file in hello/src and paste the following code into it:</p>
<pre><code class="shell">extern crate ton_client_rs;

use ton_client_rs::TonClient;

fn main() {
    let ton = TonClient::new_with_base_url(&quot;NodeSE/testnet URL&quot;).expect(&quot;Couldn't create TonClient&quot;);

    println!(&quot;Hello TON Done&quot;);
}
</code></pre>

<ol>
<li>Run the client app from <code>hello</code> directory:</li>
</ol>
<pre><code class="shell">~/ton-dev/hello$ cargo run
        ...
     Running `target\\debug\\hello.exe`
Hello TON Done
~/ton-dev/hello$
</code></pre>

<ol>
<li>Generate keys to sign the deploy transaction using <code>ton_client.crypto.generate_ed25519_keys()</code>function:</li>
</ol>
<pre><code class="rust">extern crate ton_client_rs;

use ton_client_rs::TonClient;

fn main() {
    let ton = TonClient::new_with_base_url(&quot;http://0.0.0.0&quot;).expect(&quot;Couldn't create TonClient&quot;);

    play_with_ton(ton);

    println!(&quot;Hello TON Done&quot;);
}

fn play_with_ton(ton_client: TonClient) {
    let keys = ton_client.crypto.generate_ed25519_keys().expect(&quot;Couldn't create key pair&quot;);
    println!(&quot;Generated keys: {}:{}&quot;, keys.secret, keys.public);
}
</code></pre>

<h2 id="deployment">Deployment</h2>
<p>Before a contract can be deployed, the application needs retrieve: </p>
<p>a compatible TVM code and an ABI structure. </p>
<p>Both elements were obtained at the compilation stage and stored in the <code>hello.tvc</code> and <code>hello.abi.json</code>. </p>
<blockquote>
<p><strong>Tip</strong>: For more details on the ABI, see the <a href="https://docs.ton.dev/86757ecb2/p/70c253">specification</a>.</p>
</blockquote>
<p>Below is the final contract deployment code:</p>
<pre><code class="rust">...

fn play_with_ton(ton_client: TonClient) {
    let keys = ton_client.crypto.generate_ed25519_keys().expect(&quot;Couldn't create key pair&quot;);
    println!(&quot;Generated keys:\n{}\n{}&quot;, keys.secret, keys.public);

    let code = std::fs::read(&quot;hello.tvc&quot;).expect(&quot;Couldn't read code file&quot;);
    let abi = std::fs::read_to_string(&quot;hello.abi.json&quot;).expect(&quot;Couldn't read ABI file&quot;);

    let address = ton_client.contracts.deploy(&amp;abi, &amp;code, &quot;{}&quot;.into(), &amp;keys)
        .expect(&quot;Couldn't deploy contract&quot;);
    println!(&quot;Hello contract was deployed at address: {}&quot;, address);
}

...
</code></pre>

<p>Run the contract to see how it works.</p>
<pre><code class="shell">~/ton-dev/hello$ cargo run
        ...
Running `target\\debug\\hello.exe`
Generated keys:
4236d45d544eccd16b16dea85f8aa201a7edfee06bb7f3e307c0ec02f9cb35ef
02154a29510c8bf29c4b4998e6510f60f224ab566eefaeaa9df22d7a90297b7e
Hello contract was deployed at address: b2a0d72b81d2cfae8bd3e7dc60c20a9f478570b8bea749318ff84fa0bd46d6bd
Hello TON Done
~/ton-dev/hello$   
</code></pre>

<h2 id="running-a-contract">Running a contract</h2>
<ol>
<li>Run your contract; it is also quite simple:</li>
</ol>
<pre><code class="rust">...

fn play_with_ton(ton_client: TonClient) {
    let keys = ton_client.crypto.generate_ed25519_keys().expect(&quot;Couldn't create key pair&quot;);
    println!(&quot;Generated keys:\\n{}\\n{}&quot;, keys.secret, keys.public);

    let code = std::fs::read(&quot;hello.tvc&quot;).expect(&quot;Couldn't read code file&quot;);
    let abi = std::fs::read_to_string(&quot;hello.abi.json&quot;).expect(&quot;Couldn't read ABI file&quot;);

    let address = ton_client.contracts.deploy(&amp;abi, &amp;code, &quot;{}&quot;.into(), &amp;keys)
        .expect(&quot;Couldn't deploy contract&quot;);
    println!(&quot;Hello contract was deployed at address: {}&quot;, address);

    let response = ton_client.contracts.run(&amp;address, &amp;abi, &quot;sayHello&quot;, &quot;{}&quot;.into(), Some(&amp;keys))
        .expect(&quot;Couldn't run contract&quot;);
    println!(&quot;Hello contract was responded to sayHello: {}&quot;, response);
}

...   
</code></pre>

<ol>
<li>Then run the app:</li>
</ol>
<pre><code class="shell">~/ton-dev/hello$ cargo run
    ...
Running `target\\debug\\hello.exe`
Generated keys:
a7571d6041d45c261759caa04f73034396bf1a3aa35f092d5eb83a407f8284f8
1fcf08942290cf190287659f078199b0901e9403d852142f241c630e9b1ca6b3
Hello contract was deployed at address: d8634d6164b02c3a6c1447c505147ca1dde6149ba02b61f9eb21915d62467fde
Hello contract was responded to sayHello: {&quot;value0&quot;:&quot;0x5d78a4c7&quot;}
Hello TON Done
~/ton-dev/hello$ 
</code></pre>

<blockquote>
<p>You can find more information about deploying and running in the <a href="https://docs.ton.dev/86757ecb2/p/891ee9"><strong>Working with contracts</strong></a> section.</p>
</blockquote>
<h2 id="querying-blockchain">Querying blockchain</h2>
<p>Each node server is equipped with a database that tracks the relevant blockchain.</p>
<p>This database is accessible through a GraphQL based protocol for querying blockchain.</p>
<p>The Client library contains the Query Module designed to perform GraphQL queries over a blockchain. The simplest way to query a blockchain is using the following <code>query</code> method:</p>
<pre><code class="javascript">const TRANSACTION_FIELDS: &amp;str = r#&quot;
    id 
    now 
    status
&quot;#;

let query_result = ton.queries.transactions.query(
        &amp;json!({}).to_string(),
        TRANSACTION_FIELDS).unwrap();
println(query_result);
</code></pre>

<p>Then all transactions in the relevant blockchain are displayed (the first 50, to be precise). 50  is the default number used when no limit is specified or when it exceeds 50.</p>
<p>For each transaction, we have three result fields: <strong>id</strong>, <strong>now</strong> and <strong>status</strong>.</p>
<p>We have several options to filter the results:</p>
<pre><code class="javascript">const TRANSACTION_FIELDS: &amp;str = r#&quot;
    id 
    now 
    status
&quot;#;
let query_result = ton.queries.transactions.query(
        &amp;json!({
            &quot;now&quot;: {
                &quot;eq&quot;: 1567601735
            }
        }).to_string(),
        TRANSACTION_FIELDS).unwrap(); 
</code></pre>

<p>The example gets all transactions with <strong>now</strong> equals to 1567601735. </p>
<blockquote>
<p>Find more information about a filtering in the <a href="https://docs.ton.dev/86757ecb2/p/05a847"><strong>Queries</strong></a> section.</p>
</blockquote></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
